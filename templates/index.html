<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brainflip</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .card{perspective:1000px}
        .card-inner{position:relative;width:100%;height:100%;transform-style:preserve-3d;transition:transform 0.6s}
        .card.flip .card-inner{transform:rotateY(180deg)}
        .card-face{position:absolute;width:100%;height:100%;backface-visibility:hidden;border-radius:0.5rem}
        .card-front{transform:rotateY(180deg)}
    </style>
</head>
<body class="min-h-screen bg-blue-50 flex flex-col items-center py-6">
    <header class="mb-4 text-center">
        <h1 class="text-2xl font-bold text-blue-700 mb-2">Brainflip Memory Game</h1>
        <span class="inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded" id="score-badge">Score: <span id="score">0</span></span>
    </header>
    <main class="flex flex-col items-center space-y-4">
        <div id="grid" class="grid grid-cols-6 gap-2"></div>
        <div id="win" class="hidden text-center space-y-2">
            <p class="text-xl font-semibold text-blue-700">You win!</p>
            <button id="play-again" class="bg-blue-500 text-white px-4 py-2 rounded">Play Again</button>
        </div>
    </main>
    <script>
        const cardImages=[
            '/static/images/front1.png','/static/images/front2.png','/static/images/front3.png',
            '/static/images/front4.png','/static/images/front5.png','/static/images/front6.png',
            '/static/images/front7.png','/static/images/front8.png','/static/images/front9.png',
            '/static/images/front10.png','/static/images/front11.png','/static/images/front12.png',
            '/static/images/front13.png','/static/images/front14.png','/static/images/front15.png',
            '/static/images/front16.png','/static/images/front17.png','/static/images/front18.png'
        ];
        const backImage='/static/images/back.png';

        const grid=document.getElementById('grid');
        const scoreEl=document.getElementById('score');
        const winEl=document.getElementById('win');
        const playBtn=document.getElementById('play-again');

        let first=null,second=null,lock=false,score=0;

        function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}}

        function createCard(src){
            const card=document.createElement('div');
            card.className='card bg-blue-100 rounded shadow aspect-square cursor-pointer';
            card.innerHTML=`<div class="card-inner">
                <img src="${src}" class="card-face card-front object-cover"/>
                <img src="${backImage}" class="card-face card-back object-cover"/>
            </div>`;
            card.dataset.image=src;
            card.addEventListener('click',()=>onCardClick(card));
            return card;
        }

        function onCardClick(card){
            if(lock||card.classList.contains('flip')||card.classList.contains('matched'))return;
            card.classList.add('flip');
            if(!first){first=card;return;}
            if(card===first)return; // same card
            second=card;lock=true;
            if(first.dataset.image===second.dataset.image){
                first.classList.add('matched');
                second.classList.add('matched');
                score++;scoreEl.textContent=score;
                reset();
                if(score===cardImages.length)showWin();
            }else{
                setTimeout(()=>{first.classList.remove('flip');second.classList.remove('flip');reset();},1000);
            }
        }

        function reset(){first=null;second=null;lock=false;}

        function showWin(){winEl.classList.remove('hidden');}

        function init(){
            const deck=[...cardImages,...cardImages];
            shuffle(deck);
            grid.innerHTML='';
            score=0;scoreEl.textContent=0;
            winEl.classList.add('hidden');
            deck.forEach(src=>grid.appendChild(createCard(src)));
        }

        playBtn.addEventListener('click',init);
        document.addEventListener('DOMContentLoaded',init);
    </script>
</body>
</html>
